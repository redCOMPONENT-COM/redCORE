redCORE=window.redCORE||{},redCORE.getTarget=function(e,a){var t=e.target||e.srcElement;return a&&"I"==t.tagName&&(t=t.parentElement),t},redCORE.ws={init:function(){jQuery("body").on("click",".fields-add-new-row",redCORE.ws.addNewRow).on("click",".fields-remove-row",redCORE.ws.removeRow).on("click",".ws-data-mode-switch input",redCORE.ws.toggleDataMode).on("click",".ws-validate-data-switch input",redCORE.ws.toggleValidateDataSwitch).on("click",".ws-documentationSource-switch input",redCORE.ws.toggleDocumentSource).on("click",".ws-use-forward-switch input",redCORE.ws.toggleForwardSwitch).on("click",".ws-isEnabled-trigger input",redCORE.ws.toggleEnabled).on("click",".fields-add-new-task",redCORE.ws.addNewTask).on("click",".fields-add-new-type",redCORE.ws.addNewType).on("click",".fields-edit-row",redCORE.ws.toggleEditRow).on("click",".fields-apply-row",redCORE.ws.toggleEditRow)},addNewTask:function(e){e.preventDefault();var a=jQuery(redCORE.getTarget(e,!0)),t={};if(t.taskName=a.parents(".fields-add-new-task-row").find('[name="newTask"]').val().replace(/[^\w]/g,""),""==t.taskName){var r=a.attr("data-no-task-msg");return alert(r),!1}jQuery.ajax({url:"index.php?option=com_redcore&task=webservice.ajaxGetTask",data:t,dataType:"text",beforeSend:function(){a.parents("#webserviceTabTask").addClass("opacity-40")}}).done(function(e){a.parents("#webserviceTabTask").removeClass("opacity-40").find(".tab-content:first").prepend(e),redCORE.ws.addTabLink("#taskTabs",t.taskName,"task"),jQuery("select").chosen(),jQuery(".hasTooltip").tooltip(),rRadioGroupButtonsSet("#operationTabtask-"+t.taskName),rRadioGroupButtonsEvent("#operationTabtask-"+t.taskName),jQuery("#operationTabtask-"+t.taskName+' :input[checked="checked"]').click()})},addTabLink:function(e,a,t){var r='<li><a href="#operationTab'+t+"-"+a+'" id="operation-'+t+"-"+a+'-tab" data-toggle="tab">'+t+"-"+a+"</a></li>";jQuery(e).prepend(r).find("li a:first").click()},addNewType:function(e){e.preventDefault();var a=jQuery(redCORE.getTarget(e,!0)),t={};if(t.typeName=a.parents(".fields-add-new-type-row").find('[name="newType"]').val().replace(/[^\w]/g,""),""==t.typeName){var r=a.attr("data-no-type-msg");return alert(r),!1}jQuery.ajax({url:"index.php?option=com_redcore&task=webservice.ajaxAddComplexType",data:t,dataType:"text",beforeSend:function(){a.parents("#webserviceTabComplexTypes").addClass("opacity-40")}}).done(function(e){a.parents("#webserviceTabComplexTypes").removeClass("opacity-40").find(".tab-content:first").prepend(e),redCORE.ws.addTabLink("#typeTabs",t.typeName,"type"),jQuery("select").chosen(),jQuery(".hasTooltip").tooltip(),rRadioGroupButtonsSet("#operationTabtype-"+t.typeName),rRadioGroupButtonsEvent("#operationTabtype-"+t.typeName),jQuery("#operationTabtype-"+t.typeName+' :input[checked="checked"]').click()})},addNewRow:function(e){e.preventDefault();var a=jQuery(redCORE.getTarget(e,!0)),t=a.closest("form").find('input[name="id"]'),r={};r.operation=a.find('[name="addNewRowOperation"]').val(),r.fieldList=a.find('[name="addNewRowList"]').val();var o=a.find('[name="addNewRowType"]').val(),n=a.find('[name="addNewOptionType"]').val();"undefined"==typeof n&&(n=o),"FieldFromDatabase"==n||"ResourceFromDatabase"==n?r.tableName=a.parents(".form-inline:first").find('[name="jform[main][addFromDatabase]"]').val():"ConnectWebservice"==n&&(r.webserviceId=a.parents(".form-inline:first").find('[name="jform[main][connectWebservice]"]').val()),jQuery.ajax({url:"index.php?option=com_redcore&task=webservice.ajaxGet"+n+"&id="+t.val(),data:r,dataType:"text",beforeSend:function(){a.parents("fieldset:first").addClass("opacity-40")}}).done(function(e){a.parents("fieldset:first").removeClass("opacity-40").find(".ws-row-list").prepend(e).find(".fields-edit-row:first").click(),jQuery("select").chosen(),jQuery(".hasTooltip").tooltip(),rRadioGroupButtonsSet(".ws-"+o+"-"+r.operation),rRadioGroupButtonsEvent(".ws-"+o+"-"+r.operation)})},removeRow:function(e){e.preventDefault();var a=jQuery(redCORE.getTarget(e,!0));a.parents(".row-stripped").remove()},toggleEditRow:function(e){e.preventDefault();var a=jQuery(redCORE.getTarget(e,!0)),t=a.parents(".row-stripped"),r=t.find(".ws-row-edit"),o=t.find(".ws-row-display");if("none"==r.css("display"))return r.show(),o.hide(),!0;var n={};t.find(".ws-row-edit :input").each(function(){var e=jQuery(this),a=e.attr("name");if((!e.is(":radio")||e.prop("checked"))&&"undefined"!=typeof a&&a!==!1){e.is(":radio")&&(a=a.split("_"),a=a[1]);var r=t.find(".ws-row-display-cell-"+a);r.html(e.val()),r.parent().show(),n[a]=e.val()}}),t.find(".ws-row-original").val(JSON.stringify(n)),r.hide(),o.show()},toggleEnabled:function(e){var a=jQuery(redCORE.getTarget(e,!0)),t=a.parents(".ws-operation-configuration");t.prop("disabled",0==a.val()).find("chzn-done").prop("disabled",0==a.val()).trigger("liszt:updated")},toggleForwardSwitch:function(e){var a=jQuery(redCORE.getTarget(e,!0));return""!=a.val()?(a.parents(".ws-params").find(".ws-use-operation-fieldset").hide(),!0):void a.parents(".ws-params").find(".ws-use-operation-fieldset").show()},toggleDocumentSource:function(e){var a=jQuery(redCORE.getTarget(e,!0)),t=a.val(),r=a.parents(".ws-params");redCORE.ws.toggleByDataMode(r,".ws-documentationSource",t)},toggleValidateDataSwitch:function(e){var a=jQuery(redCORE.getTarget(e,!0)),t=a.val(),r=a.parents(".ws-params");redCORE.ws.toggleByDataMode(r,".ws-validateData",t)},toggleDataMode:function(e){var a=jQuery(redCORE.getTarget(e,!0)),t=a.val(),r=a.parents(".ws-params");redCORE.ws.toggleByDataMode(r,".ws-dataMode",t)},toggleByDataMode:function(e,a,t){e.find(a).hide(),e.find(a+"-"+t).show()}};