(function(e,c,a,g){var d="searchtools";var f={formSelector:".js-stools-form",searchFieldSelector:".js-stools-field-search",clearBtnSelector:".js-stools-btn-clear",mainContainerSelector:".js-stools",searchBtnSelector:".js-stools-btn-search",filterBtnSelector:".js-stools-btn-filter",filterContainerSelector:".js-stools-container-filters",filtersHidden:true,listBtnSelector:".js-stools-btn-list",listContainerSelector:".js-stools-container-list",listHidden:false,orderColumnSelector:".js-stools-column-order",orderBtnSelector:".js-stools-btn-order",orderFieldSelector:".js-stools-field-order",orderFieldName:"list[fullordering]",limitFieldSelector:".js-stools-field-limit",defaultLimit:20,activeOrder:null,activeDirection:"ASC",chosenSupport:true,clearListOptions:false};function b(i,h){this.element=i;this.options=e.extend({},f,h);this._defaults=f;this.theForm=e(this.options.formSelector);this.filterButton=e(this.options.formSelector+" "+this.options.filterBtnSelector);this.filterContainer=e(this.options.formSelector+" "+this.options.filterContainerSelector);this.filtersHidden=this.options.filtersHidden;this.listButton=e(this.options.formSelector+" "+this.options.listBtnSelector);this.listContainer=e(this.options.formSelector+" "+this.options.listContainerSelector);this.listHidden=this.options.listHidden;this.mainContainer=e(this.options.formSelector+" "+this.options.mainContainerSelector);this.searchButton=e(this.options.formSelector+" "+this.options.searchBtnSelector);this.searchField=e(this.options.formSelector+" "+this.options.searchFieldSelector);this.searchString=null;this.clearButton=e(this.options.clearBtnSelector);this.orderCols=e(this.options.formSelector+" "+this.options.orderColumnSelector);this.orderField=e(this.options.formSelector+" "+this.options.orderFieldSelector);this.limitField=e(this.options.formSelector+" "+this.options.limitFieldSelector);this.activeColumn=null;this.activeDirection=this.options.activeDirection;this.activeOrder=this.options.activeOrder;this.activeLimit=null;this.chosenSupport=this.options.chosenSupport;this.clearListOptions=this.options.clearListOptions;this._name=d;this.init()}b.prototype={init:function(){var h=this;if(!a.addEventListener){if(this.searchField.val()===this.searchField.attr("placeholder")){this.searchField.val("")}}this.searchString=this.searchField.val();if(this.filtersHidden){this.hideFilters()}else{this.showFilters()}if(this.listHidden){this.hideList()}else{this.showList()}h.filterButton.click(function(i){h.toggleFilters();i.stopPropagation();i.preventDefault()});h.listButton.click(function(i){h.toggleList();i.stopPropagation();i.preventDefault()});h.getFilterFields().each(function(k,j){h.checkFilter(j);e(j).change(function(){h.checkFilter(j)})});h.clearButton.click(function(i){h.clear()});this.createOrderField();this.orderCols.click(function(){var i=e(this).attr("data-order");var j=e(this).attr("data-direction");var k=i+" "+j;if(i.length){h.activeColumn=i;if(k!==h.activeOrder){h.activeDirection=j;h.activeOrder=k;h.updateFieldValue(h.orderField,k)}else{h.toggleDirection()}h.theForm.submit()}})},checkFilter:function(i){var h=this;var j=e(i).find("option:selected");if(j.val()!==""){h.activeFilter(i)}else{h.deactiveFilter(i)}},clear:function(){var h=this;h.getFilterFields().each(function(k,j){e(j).val("");h.checkFilter(j);if(h.chosenSupport){e(j).trigger("liszt:updated")}});if(h.clearListOptions){h.getListFields().each(function(k,j){e(j).val("");h.checkFilter(j);if(h.chosenSupport){e(j).trigger("liszt:updated")}});e("#list_limit").val(h.options.defaultLimit);if(h.chosenSupport){e("#list_limit").trigger("liszt:updated")}}h.searchField.val("");h.theForm.submit()},activeFilter:function(i){var h=this;e(i).addClass("active");if(h.chosenSupport){e(i).chosen();var j="#"+e(i).attr("id")+"_chzn";e(j).addClass("active")}},deactiveFilter:function(i){var h=this;e(i).removeClass("active");if(h.chosenSupport){e(i).chosen();var j="#"+e(i).attr("id")+"_chzn";e(j).removeClass("active")}},getFilterFields:function(){return this.filterContainer.find("select")},getListFields:function(){return this.listContainer.find("select")},hideContainer:function(h){e(h).hide("fast");e(h).removeClass("shown")},showContainer:function(h){e(h).show("fast");e(h).addClass("shown")},toggleContainer:function(h){if(e(h).hasClass("shown")){this.hideContainer(h)}else{this.showContainer(h)}},hideList:function(){this.hideContainer(this.listContainer);this.listButton.removeClass("btn-primary")},showList:function(){this.showContainer(this.listContainer);this.listButton.addClass("btn-primary")},toggleList:function(){this.toggleContainer(this.listContainer);if(this.listContainer.hasClass("shown")){this.listButton.addClass("btn-primary")}else{this.listButton.removeClass("btn-primary")}},hideFilters:function(){this.hideContainer(this.filterContainer);this.filterButton.removeClass("btn-primary")},showFilters:function(){this.showContainer(this.filterContainer);this.filterButton.addClass("btn-primary")},toggleFilters:function(){this.toggleContainer(this.filterContainer);if(this.filterContainer.hasClass("shown")){this.filterButton.addClass("btn-primary")}else{this.filterButton.removeClass("btn-primary")}},toggleDirection:function(){var h=this;var i="ASC";if(h.activeDirection.toUpperCase()=="ASC"){i="DESC"}h.activeDirection=i;h.activeOrder=h.activeColumn+" "+i;h.updateFieldValue(h.orderField,h.activeOrder)},createOrderField:function(){var h=this;if(!this.orderField.length){this.orderField=e("<input>").attr({type:"hidden",id:"js-stools-field-order","class":"js-stools-field-order",name:h.options.orderFieldName,value:h.activeOrder+" "+this.activeDirection});this.orderField.appendTo(this.theForm)}if(this.orderField.is("select")){this.orderCols.each(function(){var k=e(this).attr("data-order");var i=e(this).attr("data-name");var l=e(this).attr("data-direction");if(k.length){k=k+" "+l;var j=h.findOption(h.orderField,k);if(!j.length){var j=e("<option>");j.text(i).val(k);if(e(this).hasClass("active")){j.attr("selected","selected")}h.orderField.append(j)}}});this.orderField.trigger("liszt:updated")}this.activeOrder=this.orderField.val()},updateFieldValue:function(m,l){var i=this;var k=m.attr("type");if(k==="hidden"||k==="text"){m.attr("value",l)}else{if(m.is("select")){var h=m.find("option").filter(function(){return e(this).val()==l});if(h.length){h.attr("selected","selected")}else{var j=e("<option>");j.text(l).val(l);j.attr("selected","selected");m.append(j)}if(i.chosenSupport){m.trigger("liszt:updated")}}}},findOption:function(h,i){return h.find("option").filter(function(){return e(this).val()==i})}};e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))}})}})(jQuery,window,document);